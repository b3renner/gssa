<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin ONG - GSSA</title>
    <link rel="icon" href="gssa_logo_transp.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-ong-container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 20px;
        }

        .status-banner {
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: none;
            align-items: center;
            gap: 15px;
        }

        .status-banner.show {
            display: flex;
        }

        .status-banner.pending {
            background: rgba(241, 196, 15, 0.15);
            border-left: 5px solid #F1C40F;
        }

        .status-banner.rejected {
            background: rgba(231, 76, 60, 0.15);
            border-left: 5px solid #E74C3C;
        }

        .status-banner.approved {
            background: rgba(46, 204, 113, 0.15);
            border-left: 5px solid #2ECC71;
        }

        .status-banner i {
            font-size: 2em;
        }

        .status-banner.pending i { color: #F1C40F; }
        .status-banner.rejected i { color: #E74C3C; }
        .status-banner.approved i { color: #2ECC71; }

        .admin-header {
            background: linear-gradient(135deg, var(--color-highlight), var(--color-tint));
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px var(--color-shadow);
        }

        .admin-header h1 {
            margin: 0 0 5px 0;
            font-size: 2em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 8px var(--color-shadow);
            text-align: center;
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--color-highlight);
            margin: 10px 0;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9em;
            text-transform: uppercase;
        }

        .tabs-container {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        .tab-button {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: var(--text-secondary);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab-button:hover {
            background: var(--bg-primary);
        }

        .tab-button.active {
            background: var(--color-highlight);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .voluntarios-grid {
            display: grid;
            gap: 20px;
        }

        .voluntario-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 8px var(--color-shadow);
            border-left: 4px solid var(--color-highlight);
            transition: transform 0.2s, box-shadow 0.3s;
        }

        .voluntario-card:hover {
            transform: translateX(5px);
            box-shadow: 0 6px 12px var(--color-shadow);
        }

        .voluntario-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .voluntario-info h3 {
            margin: 0 0 5px 0;
            color: var(--text-primary);
            font-size: 1.3em;
        }

        .voluntario-info p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .voluntario-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .detail-box {
            background: var(--bg-primary);
            padding: 12px;
            border-radius: 8px;
        }

        .detail-label {
            font-size: 0.75em;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .detail-value {
            color: var(--text-primary);
            font-size: 0.95em;
        }

        .skills-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .skill-tag {
            padding: 4px 10px;
            background: linear-gradient(135deg, var(--color-highlight), var(--color-tint));
            color: white;
            border-radius: 12px;
            font-size: 0.8em;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-approve, .btn-reject {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-approve {
            background: #2ECC71;
            color: white;
        }

        .btn-approve:hover {
            background: #27AE60;
            transform: translateY(-2px);
        }

        .btn-reject {
            background: #E74C3C;
            color: white;
        }

        .btn-reject:hover {
            background: #C0392B;
            transform: translateY(-2px);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 5em;
            color: var(--bg-map-border);
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .loading i {
            font-size: 3em;
            color: var(--color-highlight);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .edit-form {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 8px var(--color-shadow);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .btn-save {
            background: var(--color-highlight);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
        }

        .btn-save:hover {
            background: var(--color-tint);
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .voluntario-details {
                grid-template-columns: 1fr;
            }

            .tabs-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-left">
            <img src="gssa_logo.png" alt="Logo GSSA" class="gssa-logo-img">
            <div class="logo-titles">
                <h1 class="logo-main-title">GSSA</h1>
                <p class="logo-subtitle">Gravata√≠ Support & Shelter Assist</p>
            </div>
        </div>
        <nav class="header-right">
            <a href="index.html" class="nav-button">In√≠cio</a>
            <button id="logout-button" class="volunteer-button" style="background: var(--color-error);">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
            <button id="theme-toggle" class="toggle-button">
                <i class="fas fa-sun"></i>
            </button>
        </nav>
    </header>

    <div class="admin-ong-container">
        <div id="status-banner" class="status-banner">
            <i class="fas fa-info-circle"></i>
            <div class="status-banner-content">
                <h3 id="status-title">T√≠tulo do Status</h3>
                <p id="status-message">Mensagem do status</p>
            </div>
        </div>

        <div id="loading-state" class="loading">
            <i class="fas fa-spinner"></i>
            <p>Carregando dados da ONG...</p>
        </div>

        <div id="main-content" style="display: none;">
            <div class="admin-header">
                <h1 id="ong-name">Nome da ONG</h1>
                <p id="ong-subtitle">Painel Administrativo</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="stat-total">0</div>
                    <div class="stat-label">Total Inscri√ß√µes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-pending" style="color: #F1C40F;">0</div>
                    <div class="stat-label">Pendentes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-approved" style="color: #2ECC71;">0</div>
                    <div class="stat-label">Aprovados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-rejected" style="color: #E74C3C;">0</div>
                    <div class="stat-label">Rejeitados</div>
                </div>
            </div>

            <div class="tabs-container">
                <button class="tab-button active" data-tab="inscricoes">
                    <i class="fas fa-users"></i> Gerenciar Inscri√ß√µes
                </button>
                <button class="tab-button" data-tab="dados">
                    <i class="fas fa-building"></i> Dados da ONG
                </button>
                <button class="tab-button" data-tab="estatisticas">
                    <i class="fas fa-chart-bar"></i> Estat√≠sticas
                </button>
            </div>

            <div id="tab-inscricoes" class="tab-content active">
                <div id="inscricoes-container" class="voluntarios-grid">
                    <!-- Volunt√°rios ser√£o inseridos aqui -->
                </div>
                <div id="empty-inscricoes" class="empty-state" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <h2>Nenhuma inscri√ß√£o ainda</h2>
                    <p>Quando volunt√°rios se inscreverem na sua ONG, eles aparecer√£o aqui.</p>
                </div>
            </div>

            <div id="tab-dados" class="tab-content">
                <div class="edit-form">
                    <h2 style="color: var(--color-tint); margin-bottom: 20px;">
                        <i class="fas fa-edit"></i> Editar Informa√ß√µes da ONG
                    </h2>
                    
                    <form id="edit-ong-form">
                        <div class="form-group">
                            <label for="edit-name">Nome da ONG</label>
                            <input type="text" id="edit-name" class="form-control" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-phone">Telefone</label>
                                <input type="tel" id="edit-phone" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-email">E-mail</label>
                                <input type="email" id="edit-email" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="edit-description">Descri√ß√£o</label>
                            <textarea id="edit-description" rows="4" required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="edit-services">Servi√ßos Oferecidos</label>
                            <input type="text" id="edit-services" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-capacity">Capacidade (pessoas/dia)</label>
                                <input type="number" id="edit-capacity">
                            </div>
                            <div class="form-group">
                                <label for="edit-schedule">Hor√°rio de Funcionamento</label>
                                <input type="text" id="edit-schedule" required>
                            </div>
                        </div>

                        <button type="submit" class="btn-save">
                            <i class="fas fa-save"></i> Salvar Altera√ß√µes
                        </button>
                    </form>
                </div>
            </div>

            <div id="tab-estatisticas" class="tab-content">
                <div class="edit-form">
                    <h2 style="color: var(--color-tint); margin-bottom: 20px;">
                        <i class="fas fa-chart-line"></i> Estat√≠sticas Detalhadas
                    </h2>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">
                        Visualize dados sobre volunt√°rios e atividades da sua ONG
                    </p>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Habilidades Mais Comuns</div>
                            <div id="top-skills" style="margin-top: 15px; text-align: left;">
                                <!-- Ser√° preenchido dinamicamente -->
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Taxa de Aprova√ß√£o</div>
                            <div class="stat-number" id="approval-rate" style="font-size: 2em;">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, getDocs, doc, getDoc, updateDoc, query, where, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDhQs9Kz4LLGaKIhWV9nUiTjlst5YEWhjg",
            authDomain: "gssa-gravatai.firebaseapp.com",
            projectId: "gssa-gravatai",
            storageBucket: "gssa-gravatai.firebasestorage.app",
            messagingSenderId: "650753472587",
            appId: "1:650753472587:web:65b706993648dc602975ce"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let ongData = null;
        let ongId = null;
        let applications = [];

        const loadingState = document.getElementById('loading-state');
        const mainContent = document.getElementById('main-content');
        const statusBanner = document.getElementById('status-banner');
        const themeToggle = document.getElementById('theme-toggle');
        const logoutButton = document.getElementById('logout-button');

        // Tema
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            themeToggle.querySelector('i').classList.replace('fa-sun', 'fa-moon');
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            const icon = themeToggle.querySelector('i');
            if (isDark) {
                icon.classList.replace('fa-sun', 'fa-moon');
                localStorage.setItem('theme', 'dark');
            } else {
                icon.classList.replace('fa-moon', 'fa-sun');
                localStorage.setItem('theme', 'light');
            }
        });

        logoutButton.addEventListener('click', async () => {
            await signOut(auth);
            window.location.href = 'index.html';
        });

        // Verificar autentica√ß√£o
        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                alert('Voc√™ precisa estar logado!');
                window.location.href = 'index.html';
                return;
            }

            const userDoc = await getDoc(doc(db, 'users', user.uid));
            if (!userDoc.exists() || userDoc.data().role !== 'ong') {
                alert('Acesso negado! Apenas ONGs podem acessar este painel.');
                window.location.href = 'index.html';
                return;
            }

            await loadOngData(user.uid);
        });

        // Carregar dados da ONG
        async function loadOngData(userId) {
            try {
                const ongsRef = collection(db, 'ongs');
                const q = query(ongsRef, where('adminUserId', '==', userId));
                const snapshot = await getDocs(q);

                if (snapshot.empty) {
                    throw new Error('ONG n√£o encontrada');
                }

                const ongDoc = snapshot.docs[0];
                ongId = ongDoc.id;
                ongData = ongDoc.data();

                console.log('‚úÖ ONG carregada - ID:', ongId);

                checkOngStatus();
                await loadApplications();
                renderDashboard();

                loadingState.style.display = 'none';
                mainContent.style.display = 'block';

            } catch (error) {
                console.error('Erro:', error);
                loadingState.innerHTML = `
                    <i class="fas fa-exclamation-triangle" style="color: var(--color-error);"></i>
                    <p>Erro ao carregar dados: ${error.message}</p>
                `;
            }
        }

        function checkOngStatus() {
            const status = ongData.status;
            
            if (status === 'pending') {
                statusBanner.className = 'status-banner pending show';
                document.getElementById('status-title').textContent = '‚è≥ Aguardando Aprova√ß√£o';
                document.getElementById('status-message').textContent = 'Sua ONG est√° em an√°lise. Voc√™ ser√° notificado quando for aprovada.';
            } else if (status === 'rejected') {
                statusBanner.className = 'status-banner rejected show';
                document.getElementById('status-title').textContent = '‚ùå Cadastro Rejeitado';
                const reason = ongData.rejectionReason || 'N√£o especificado';
                document.getElementById('status-message').textContent = `Motivo: ${reason}. Entre em contato para mais informa√ß√µes.`;
            } else if (status === 'approved') {
                statusBanner.className = 'status-banner approved show';
                document.getElementById('status-title').textContent = '‚úÖ ONG Aprovada';
                document.getElementById('status-message').textContent = 'Sua ONG est√° ativa e pode receber volunt√°rios!';
                
                setTimeout(() => {
                    statusBanner.classList.remove('show');
                }, 5000);
            }
        }

        // ‚úÖ CORRE√á√ÉO: Buscar inscri√ß√µes pelo ID da ONG (STRING)
        async function loadApplications() {
            try {
                console.log('üîç Buscando inscri√ß√µes para ONG ID:', ongId);
                
                // Buscar como string
                const q = query(collection(db, 'applications'), where('ongId', '==', String(ongId)));
                const snapshot = await getDocs(q);

                console.log(`üìä ${snapshot.size} inscri√ß√µes encontradas`);

                applications = [];
                for (const docSnap of snapshot.docs) {
                    const appData = docSnap.data();
                    console.log('üìù Inscri√ß√£o encontrada:', appData);
                    
                    // Buscar dados do volunt√°rio
                    const voluntarioDoc = await getDoc(doc(db, 'users', appData.userId));
                    if (voluntarioDoc.exists()) {
                        applications.push({
                            id: docSnap.id,
                            ...appData,
                            voluntarioData: voluntarioDoc.data()
                        });
                    }
                }

                console.log(`‚úÖ ${applications.length} inscri√ß√µes carregadas com dados`);
                updateStats();
                renderApplications();
            } catch (error) {
                console.error('‚ùå Erro ao carregar inscri√ß√µes:', error);
            }
        }

        function updateStats() {
            const total = applications.length;
            const pending = applications.filter(a => a.status === 'pending').length;
            const approved = applications.filter(a => a.status === 'approved').length;
            const rejected = applications.filter(a => a.status === 'rejected').length;

            document.getElementById('stat-total').textContent = total;
            document.getElementById('stat-pending').textContent = pending;
            document.getElementById('stat-approved').textContent = approved;
            document.getElementById('stat-rejected').textContent = rejected;

            const rate = total > 0 ? ((approved / total) * 100).toFixed(0) : 0;
            document.getElementById('approval-rate').textContent = `${rate}%`;

            // Habilidades mais comuns
            const skills = {};
            applications.forEach(app => {
                if (app.voluntarioData.skills) {
                    app.voluntarioData.skills.forEach(skill => {
                        skills[skill] = (skills[skill] || 0) + 1;
                    });
                }
            });

            const topSkills = Object.entries(skills)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);

            const topSkillsHtml = topSkills.length > 0
                ? topSkills.map(([skill, count]) => `
                    <div style="display: flex; justify-content: space-between; padding: 5px 0;">
                        <span>${skill}</span>
                        <strong>${count}</strong>
                    </div>
                `).join('')
                : '<p style="color: var(--text-secondary);">Sem dados</p>';

            document.getElementById('top-skills').innerHTML = topSkillsHtml;
        }

        function renderDashboard() {
            document.getElementById('ong-name').textContent = ongData.basicInfo.name;
            document.getElementById('ong-subtitle').textContent = `CNPJ: ${ongData.basicInfo.cnpj}`;

            document.getElementById('edit-name').value = ongData.basicInfo.name;
            document.getElementById('edit-phone').value = ongData.basicInfo.phone;
            document.getElementById('edit-email').value = ongData.basicInfo.email;
            document.getElementById('edit-description').value = ongData.description;
            document.getElementById('edit-services').value = ongData.services;
            document.getElementById('edit-capacity').value = ongData.capacity || '';
            document.getElementById('edit-schedule').value = ongData.schedule;
        }

        function renderApplications() {
            const container = document.getElementById('inscricoes-container');
            const emptyState = document.getElementById('empty-inscricoes');

            if (applications.length === 0) {
                container.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }

            container.style.display = 'grid';
            emptyState.style.display = 'none';
            container.innerHTML = '';

            applications.forEach(app => {
                const card = createVoluntarioCard(app);
                container.appendChild(card);
            });
        }

        function createVoluntarioCard(app) {
            const voluntario = app.voluntarioData;
            const statusClass = app.status === 'approved' ? 'status-approved' : 
                               app.status === 'rejected' ? 'status-rejected' : 'status-pending';
            const statusText = app.status === 'approved' ? 'Aprovado' : 
                              app.status === 'rejected' ? 'Rejeitado' : 'Pendente';

            const createdAt = app.createdAt?.toDate 
                ? app.createdAt.toDate().toLocaleDateString('pt-BR')
                : 'Data n√£o dispon√≠vel';

            const card = document.createElement('div');
            card.className = 'voluntario-card';
            card.innerHTML = `
                <div class="voluntario-header">
                    <div class="voluntario-info">
                        <h3>${voluntario.name}</h3>
                        <p><i class="fas fa-envelope"></i> ${voluntario.email}</p>
                        <p><i class="fas fa-map-marker-alt"></i> ${voluntario.location || 'N√£o informado'}</p>
                        <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 5px;">
                            <i class="fas fa-calendar"></i> Inscrito em: ${createdAt}
                        </p>
                    </div>
                    <span class="status-badge ${statusClass}">${statusText}</span>
                </div>

                <div class="voluntario-details">
                    <div class="detail-box">
                        <div class="detail-label">Disponibilidade</div>
                        <div class="detail-value">${voluntario.availability || 'N√£o informado'}</div>
                    </div>
                    <div class="detail-box">
                        <div class="detail-label">Habilidades</div>
                        <div class="skills-tags">
                            ${voluntario.skills && voluntario.skills.length > 0 
                                ? voluntario.skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('') 
                                : '<span style="color: var(--text-secondary);">Nenhuma cadastrada</span>'}
                        </div>
                    </div>
                </div>

                ${app.status === 'pending' ? `
                    <div class="action-buttons">
                        <button class="btn-approve" onclick="handleApprove('${app.id}')">
                            <i class="fas fa-check"></i> Aprovar
                        </button>
                        <button class="btn-reject" onclick="handleReject('${app.id}')">
                            <i class="fas fa-times"></i> Rejeitar
                        </button>
                    </div>
                ` : ''}
            `;

            return card;
        }

        window.handleApprove = async function(appId) {
            if (!confirm('Aprovar este volunt√°rio?')) return;

            try {
                await updateDoc(doc(db, 'applications', appId), {
                    status: 'approved',
                    reviewedAt: serverTimestamp(),
                    reviewedBy: auth.currentUser.uid
                });

                alert('Volunt√°rio aprovado!');
                await loadApplications();
            } catch (error) {
                alert('Erro: ' + error.message);
            }
        };

        window.handleReject = async function(appId) {
            const reason = prompt('Motivo da rejei√ß√£o (opcional):');
            
            try {
                await updateDoc(doc(db, 'applications', appId), {
                    status: 'rejected',
                    reviewedAt: serverTimestamp(),
                    reviewedBy: auth.currentUser.uid,
                    rejectionReason: reason || 'N√£o especificado'
                });

                alert('Inscri√ß√£o rejeitada.');
                await loadApplications();
            } catch (error) {
                alert('Erro: ' + error.message);
            }
        };

        // Sistema de Tabs
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                button.classList.add('active');
                const tabId = 'tab-' + button.dataset.tab;
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Salvar edi√ß√£o da ONG
        document.getElementById('edit-ong-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const updatedData = {
                basicInfo: {
                    ...ongData.basicInfo,
                    name: document.getElementById('edit-name').value,
                    phone: document.getElementById('edit-phone').value,
                    email: document.getElementById('edit-email').value
                },
                description: document.getElementById('edit-description').value,
                services: document.getElementById('edit-services').value,
                capacity: parseInt(document.getElementById('edit-capacity').value) || null,
                schedule: document.getElementById('edit-schedule').value,
                updatedAt: serverTimestamp()
            };

            try {
                await updateDoc(doc(db, 'ongs', ongId), updatedData);
                alert('Dados atualizados com sucesso!');
                ongData = { ...ongData, ...updatedData };
                renderDashboard();
            } catch (error) {
                alert('Erro ao salvar: ' + error.message);
            }
        });
    </script>
</body>
</html>